---
import "./contact.css";
import ContactForm from "./islands/ContactForm";
import CtaButton from "../../ui/CtaButton/CtaButton.astro";

const EMAIL = "hello@kersivo.co.uk";
const CALENDLY = "#"; // TODO: wstaw link do bookingu (Calendly) gdy gotowe

// ✅ SEO: landing = h2, /contact = h1
const { asPage = false } = Astro.props;
const TitleTag = asPage ? "h1" : "h2";
const titleId = asPage ? "contact-page-title" : "contact-title";
---

<section id="contact" class="k-contact section" aria-labelledby={titleId}>
  <div class="container">
    <div class="k-contact2" data-contact-root>
      <div class="k-contact2__frame" data-contact-frame>
        <span class="k-contact2__glow" aria-hidden="true"></span>
        <span class="k-contact2__dots" aria-hidden="true"></span>

        <div class="k-contact2__grid">
          <!-- LEFT -->
          <div class="k-contact2__left">
            <TitleTag class="k-contact2__title" id={titleId}>
              Tell us about your<br />project
            </TitleTag>

            <ul class="k-contact2__bullets" aria-label="Contact benefits">
              <li class="k-contact2__bullet">
                <span class="k-contact2__check" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2" opacity=".95" />
                    <path d="M8.4 12.3l2.3 2.3 5.2-5.2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </span>
                <span>We will respond to you within 12 hours</span>
              </li>

              <li class="k-contact2__bullet">
                <span class="k-contact2__check" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2" opacity=".95" />
                    <path d="M8.4 12.3l2.3 2.3 5.2-5.2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </span>
                <span>We’ll sign an NDA if requested</span>
              </li>

              <li class="k-contact2__bullet">
                <span class="k-contact2__check" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2" opacity=".95" />
                    <path d="M8.4 12.3l2.3 2.3 5.2-5.2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </span>
                <span>Access to dedicated consultant specialists</span>
              </li>
            </ul>

            <div class="k-contact2__meta">
              <a class="k-contact2__email" href={`mailto:${EMAIL}`}>{EMAIL}</a>

              <p class="k-contact2__note">
                Always busy and want to book<br />
                an exact time to call?
              </p>

              <div class="k-contact2__cta">
                <CtaButton href={CALENDLY} label="Book a free call" variant="ghost" magnetic={false} />
              </div>
            </div>
          </div>

          <!-- RIGHT -->
          <div class="k-contact2__right">
            <ContactForm client:load emailTo={EMAIL} />
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    (() => {
      const root = document.querySelector("#contact [data-contact-root]");
      if (!root) return;

      const reduced =
        window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      if (reduced) return;

      let raf = 0;
      let x = 0, y = 0;

      const paint = () => {
        raf = 0;
        const r = root.getBoundingClientRect();
        const mx = ((x - r.left) / r.width) * 100;
        const my = ((y - r.top) / r.height) * 100;
        root.style.setProperty("--mx", mx.toFixed(2) + "%");
        root.style.setProperty("--my", my.toFixed(2) + "%");
      };

      root.addEventListener(
        "pointermove",
        (e) => {
          x = e.clientX;
          y = e.clientY;
          if (!raf) raf = requestAnimationFrame(paint);
        },
        { passive: true }
      );
    })();
  </script>
</section>
