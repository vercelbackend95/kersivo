---
import "./testimonials.css";
import ReviewsCarousel from "./ReviewsCarousel";


type Testimonial = {
  quote: string;
  name: string;
  role: string;
  avatar?: string; // optional local/public path
  blank?: boolean; // keeps layout but can be empty
};

interface Props {
  kicker?: string;
  title?: string;
  subtitle?: string;

  leftStatValue?: string;
  leftStatLabel?: string;

  rightStatValue?: string;
  rightStatLabel?: string;

  avatars?: { label: string }[];
  testimonials?: Testimonial[];
}

const {
  kicker = "REVIEWS",
  title = "What people say",
  subtitle = "Short, real words from people I’ve worked with — focused on delivery, clarity, and taste.",

  leftStatValue = "98%",
  leftStatLabel = "Customer satisfaction rate",

  rightStatValue = "+2K",
  rightStatLabel = "Happy Customers",

  avatars = [{ label: "A" }, { label: "S" }, { label: "M" }, { label: "J" }],

  testimonials = [
    {
      quote:
        "No fluff — just organised execution. Milestones were clear and the polish level was genuinely premium.",
      name: "Tom W.",
      role: "Small Business Owner (UK)",
    },
    {
      quote:
        "Detail-obsessed in the best way. Everything feels intentional, fast, and built to convert — especially on mobile.",
      name: "Aisha K.",
      role: "Founder (UK)",
    },
    {
      quote:
        "Clean comms, calm delivery. The process removed doubts early and the finish felt… expensive (in a good way).",
      name: "Sophia M.",
      role: "Product Designer",
    },
  ],
} = Astro.props as Props;
---

<section id="reviews" class="section k-reviews" data-section>
  <div class="container">
    <header class="k-reviews__head sectionTitle">
      <h6>{kicker}</h6>

      <div class="k-reviews__headRow">
        <div class="k-reviews__titles">
          <h2>{title}</h2>
          <p class="k-reviews__sub measure">{subtitle}</p>
        </div>

        <div class="k-reviews__note" aria-hidden="true">
          <span class="k-reviews__noteDot"></span>
          <span>References available on request.</span>
        </div>
      </div>
    </header>

    <div class="k-reviews__grid">
      <!-- LEFT: portrait + big stat -->
      <article class="k-reviews__card k-reviews__card--left" aria-label="Satisfaction highlight">
        <div class="k-reviews__portrait" role="img" aria-label="Studio portrait placeholder">
          <div class="k-reviews__portraitGlow" aria-hidden="true"></div>
          <div class="k-reviews__portraitGrain" aria-hidden="true"></div>
        </div>

        <div class="k-reviews__stat">
          <div class="k-reviews__statValue">{leftStatValue}</div>
          <div class="k-reviews__statLabel">{leftStatLabel}</div>
        </div>
      </article>

      <!-- RIGHT: mini stat + main quote carousel -->
      <div class="k-reviews__right">
        <article class="k-reviews__card k-reviews__card--mini" aria-label="Happy customers highlight">
          <div class="k-reviews__avatars" aria-hidden="true">
            {avatars.slice(0, 4).map((a, i) => (
              <span class="k-reviews__avatar" style={`--i:${i}`} title={a.label}>
                <span class="k-reviews__avatarInner">{a.label}</span>
              </span>
            ))}
          </div>

          <div class="k-reviews__miniStat">
            <div class="k-reviews__miniValue">{rightStatValue}</div>
            <div class="k-reviews__miniLabel">{rightStatLabel}</div>
          </div>
        </article>

        <article class="k-reviews__card k-reviews__card--main" aria-label="Testimonials">
          <ReviewsCarousel testimonials={testimonials.filter(t => !t.blank && t.quote?.trim())} client:visible />
        </article>
      </div>
    </div>
  </div>
</section>
